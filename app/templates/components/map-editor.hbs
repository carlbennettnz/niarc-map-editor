<svg class="map" version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <pattern id="grid-pattern" x={{viewport.scrollX}} y={{viewport.scrollY}} width="20" height="20" patternUnits="userSpaceOnUse">
      <line x1="0" y1="0" x2="0" y2="20" />
      <line x1="0" y1="0" x2="20" y2="0" />
    </pattern>
  </defs>

  <rect fill="url(#grid-pattern)" x="0" y="0" width="100%" height="100%"/>

  {{! x and y axes }}
  <line class="axes x" x1="0" y1={{viewport.scrollY}} x2="100%" y2={{viewport.scrollY}}></line>
  <line class="axes y" y1="0" x1={{viewport.scrollX}} y2="100%" x2={{viewport.scrollX}}></line>

  <g class="scroll-offset" transform={{scrollTransform}}>
    {{#each layers as |layer|}}
      {{#if layer.isVisible}}
        {{#each lines as |line|}}
          {{#unless (or line.isHidden (not-eq line.layer layer.name))}}
            <g class="wall {{if line.isInProgress 'in-progress'}} {{if line.isSelected 'selected'}}">
              <line
                x1={{scale line.points.x1 viewport.zoom}}
                y1={{scale line.points.y1 viewport.zoom}}
                x2={{scale line.points.x2 viewport.zoom}}
                y2={{scale line.points.y2 viewport.zoom}}></line>

              {{#if line.isSelected}}
                <circle class="handle" cx={{scale line.points.x1 viewport.zoom}} cy={{scale line.points.y1 viewport.zoom}} r="4"></circle>
                <circle class="handle" cx={{scale line.points.x2 viewport.zoom}} cy={{scale line.points.y2 viewport.zoom}} r="4"></circle>
              {{/if}}
            </g>
          {{/unless}}
        {{/each}}
      {{/if}}
    {{/each}}
  </g>
</svg>
